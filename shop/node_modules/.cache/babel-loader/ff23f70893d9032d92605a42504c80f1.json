{"ast":null,"code":"import _regeneratorRuntime from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import getCategories from'../api/get/getCategories';import InputEditCategoryName from'./InputEditCategoryNameComponent';import PopUp from'../../../common/popup/components/PopUpComponent';import PopUpSomethingWentWrong from'../../../common/popup/components/PopUpSomethingWentWrongComponent';import EditCategoryImage from'./EditCategoryImageComponent';import postDeleteCategory from'../api/post/postDeleteCategory';import postCategory from'../api/post/postCategory';import ImagePhoto from'../../../common/image/components/ImagePhotoComponent';import ButtonEditCategory from'../../../common/button/components/ButtonEditCategoryComponent';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditCategoryPageColumns=/*#__PURE__*/function(_React$Component){_inherits(EditCategoryPageColumns,_React$Component);var _super=_createSuper(EditCategoryPageColumns);function EditCategoryPageColumns(props){var _this;_classCallCheck(this,EditCategoryPageColumns);_this=_super.call(this,props);_this._isMounted=false;_this.handleButtonOnSave=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(category){var _this$state,isEditActiveId,isUpdated,categoryImage,categoryName;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=_this.state,isEditActiveId=_this$state.isEditActiveId,isUpdated=_this$state.isUpdated,categoryImage=_this$state.categoryImage,categoryName=_this$state.categoryName;_context.next=3;return postCategory(isEditActiveId,categoryName,categoryImage);case 3:_this.setState({isUpdated:!isUpdated,isEditActive:false,isEditActiveId:category.id,IsEditButtonVisible:false});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleButtonOnEdit=function(category){_this.setState({isEditActive:true,isEditActiveId:category.id,IsEditButtonVisible:true,categoryImage:category.image,categoryName:category.category});};_this.setpopupSmthWentWrongActive=function(value){_this.setState({popupSmthWentWrongActive:value});};_this.updateData=function(value,valueisLoading){if(_this._isMounted){_this.setState({categoriesArray:value,isLoading:valueisLoading});}};_this.updateCategoryImage=function(value){return _this.setState({categoryImage:value});};_this.updateCategoryName=function(value){return _this.setState({categoryName:value});};_this.updateAfterDelete=function(){var isUpdated=_this.state.isUpdated;_this.setState({isUpdated:!isUpdated});};_this.state={categoriesArray:[],isEditActive:false,isEditActiveId:'',isLoading:false,ErrorMessage:'',popupSmthWentWrongActive:true,IsEditButtonVisible:true,isUpdated:false,categoryImage:'',categoryName:''};return _this;}_createClass(EditCategoryPageColumns,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this._isMounted=true;_context2.next=3;return getCategories(this.updateData,this.setError);case 3:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(prevProps,prevState){var isUpdated;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isUpdated=this.state.isUpdated;if(!(prevState.isUpdated!==isUpdated)){_context3.next=4;break;}_context3.next=4;return getCategories(this.updateData,this.setError);case 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidUpdate(_x2,_x3){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,categoriesArray=_this$state2.categoriesArray,isEditActive=_this$state2.isEditActive,isEditActiveId=_this$state2.isEditActiveId,isLoading=_this$state2.isLoading,ErrorMessage=_this$state2.ErrorMessage,popupSmthWentWrongActive=_this$state2.popupSmthWentWrongActive,IsEditButtonVisible=_this$state2.IsEditButtonVisible;if(!isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"-isLoading\",children:\" \"});}if(ErrorMessage){return/*#__PURE__*/_jsx(PopUp,{active:popupSmthWentWrongActive,setActive:this.setpopupSmthWentWrongActive,children:/*#__PURE__*/_jsx(PopUpSomethingWentWrong,{text:\"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0435\\u0449\\u0435 \\u0440\\u0430\\u0437\",setpopupSmthWentWrongActive:this.setpopupSmthWentWrongActive})});}return/*#__PURE__*/_jsx(_Fragment,{children:categoriesArray.categories.map(function(category){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"columnImage\",children:(isEditActive&&category.id)!==isEditActiveId?/*#__PURE__*/_jsx(_Fragment,{children:category.image?/*#__PURE__*/_jsx(ImagePhoto,{className:\"imageCategory\",imagePreviewUrl:category.image}):/*#__PURE__*/_jsx(ImagePhoto,{className:\"setImage\",imagePreviewUrl:category.imgAlt})}):/*#__PURE__*/_jsx(EditCategoryImage,{id:category.id,updateCategoryImage:_this2.updateCategoryImage})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnName\",children:isEditActive&&category.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditCategoryName,{id:category.id,category:category.category,updateCategoryName:_this2.updateCategoryName}):/*#__PURE__*/_jsx(\"p\",{children:category.category})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnEdit\",children:/*#__PURE__*/_jsx(ButtonEditCategory,{className:\"editCategoryButton\",category:category,handleButtonOnDelete:\"\",handleButtonOnSave:_this2.handleButtonOnSave,handleButtonOnEdit:_this2.handleButtonOnEdit,IsEditButtonVisible:IsEditButtonVisible,isEditActive:isEditActive,isEditActiveId:isEditActiveId})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnDelete\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"deleteCategoryButton\",onClick:function onClick(){return postDeleteCategory(category.id,_this2.updateAfterDelete);},children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]})},category.id);})});}}]);return EditCategoryPageColumns;}(React.Component);export default EditCategoryPageColumns;","map":{"version":3,"sources":["/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/src/pages/editCategory/components/EditCategoryPageColumnsComponent.jsx"],"names":["React","getCategories","InputEditCategoryName","PopUp","PopUpSomethingWentWrong","EditCategoryImage","postDeleteCategory","postCategory","ImagePhoto","ButtonEditCategory","EditCategoryPageColumns","props","_isMounted","handleButtonOnSave","category","state","isEditActiveId","isUpdated","categoryImage","categoryName","setState","isEditActive","id","IsEditButtonVisible","handleButtonOnEdit","image","setpopupSmthWentWrongActive","value","popupSmthWentWrongActive","updateData","valueisLoading","categoriesArray","isLoading","updateCategoryImage","updateCategoryName","updateAfterDelete","ErrorMessage","setError","prevProps","prevState","categories","map","imgAlt","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport getCategories from '../api/get/getCategories';\nimport InputEditCategoryName from './InputEditCategoryNameComponent';\nimport PopUp from '../../../common/popup/components/PopUpComponent';\nimport PopUpSomethingWentWrong from '../../../common/popup/components/PopUpSomethingWentWrongComponent';\nimport EditCategoryImage from './EditCategoryImageComponent';\nimport postDeleteCategory from '../api/post/postDeleteCategory';\nimport postCategory from '../api/post/postCategory';\nimport ImagePhoto from '../../../common/image/components/ImagePhotoComponent';\nimport ButtonEditCategory from '../../../common/button/components/ButtonEditCategoryComponent';\n\nclass EditCategoryPageColumns extends React.Component {\n  _isMounted = false;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      categoriesArray: [],\n      isEditActive: false,\n      isEditActiveId: '',\n      isLoading: false,\n      ErrorMessage: '',\n      popupSmthWentWrongActive: true,\n      IsEditButtonVisible: true,\n      isUpdated: false,\n      categoryImage: '',\n      categoryName: '',\n    };\n  }\n\n  async componentDidMount() {\n    this._isMounted = true;\n    await getCategories(this.updateData, this.setError);\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    const { isUpdated } = this.state;\n    if (prevState.isUpdated !== isUpdated) {\n      await getCategories(this.updateData, this.setError);\n    }\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n   handleButtonOnSave = async (category) => {\n     const {\n       isEditActiveId, isUpdated, categoryImage, categoryName,\n     } = this.state;\n     await postCategory(isEditActiveId, categoryName, categoryImage);\n     this.setState({\n       isUpdated: !isUpdated,\n       isEditActive: false,\n       isEditActiveId: category.id,\n       IsEditButtonVisible: false,\n     });\n   }\n\n   handleButtonOnEdit = (category) => {\n     this.setState({\n       isEditActive: true,\n       isEditActiveId: category.id,\n       IsEditButtonVisible: true,\n       categoryImage: category.image,\n       categoryName: category.category,\n     });\n   };\n\n  setpopupSmthWentWrongActive = (value) => { this.setState({ popupSmthWentWrongActive: value }); }\n\n  updateData = (value, valueisLoading) => {\n    if (this._isMounted) {\n      this.setState({ categoriesArray: value, isLoading: valueisLoading });\n    }\n  }\n\n  updateCategoryImage = (value) => this.setState({ categoryImage: value })\n\n  updateCategoryName = (value) => this.setState({ categoryName: value })\n\n  updateAfterDelete = () => {\n    const { isUpdated } = this.state;\n    this.setState({ isUpdated: !isUpdated });\n  }\n\n  render() {\n    const {\n      categoriesArray, isEditActive, isEditActiveId, isLoading,\n      ErrorMessage, popupSmthWentWrongActive, IsEditButtonVisible,\n    } = this.state;\n\n    if (!isLoading) {\n      return <div className=\"-isLoading\"> </div>;\n    }\n    if (ErrorMessage) {\n      return (\n        <PopUp\n          active={popupSmthWentWrongActive}\n          setActive={this.setpopupSmthWentWrongActive}\n        >\n          <PopUpSomethingWentWrong\n            text=\"Попробуйте еще раз\"\n            setpopupSmthWentWrongActive={this.setpopupSmthWentWrongActive}\n          />\n        </PopUp>\n      );\n    }\n    return (\n      <>\n        {categoriesArray.categories.map((category) => (\n          <li key={category.id}>\n            <div className=\"columns\">\n              <div className=\"columnImage\">\n                {(isEditActive && category.id) !== isEditActiveId\n                  ? (\n                    <>\n                      {category.image\n                        ? <ImagePhoto className=\"imageCategory\" imagePreviewUrl={category.image} />\n                        : <ImagePhoto className=\"setImage\" imagePreviewUrl={category.imgAlt} />}\n                    </>\n                  ) : (\n                    <EditCategoryImage\n                      id={category.id}\n                      updateCategoryImage={this.updateCategoryImage}\n                    />\n                  )}\n              </div>\n              <div className=\"columnName\">\n                {isEditActive && category.id === isEditActiveId\n                  ? (\n                    <InputEditCategoryName\n                      id={category.id}\n                      category={category.category}\n                      updateCategoryName={this.updateCategoryName}\n                    />\n                  ) : <p>{category.category}</p>}\n              </div>\n              <div className=\"columnEdit\">\n                <ButtonEditCategory\n                  className=\"editCategoryButton\"\n                  category={category}\n                  handleButtonOnDelete=\"\"\n                  handleButtonOnSave={this.handleButtonOnSave}\n                  handleButtonOnEdit={this.handleButtonOnEdit}\n                  IsEditButtonVisible={IsEditButtonVisible}\n                  isEditActive={isEditActive}\n                  isEditActiveId={isEditActiveId}\n                />\n              </div>\n              <div className=\"columnDelete\">\n                <button\n                  type=\"button\"\n                  className=\"deleteCategoryButton\"\n                  onClick={() => postDeleteCategory(category.id, this.updateAfterDelete)}\n                >\n                  Удалить\n                </button>\n              </div>\n            </div>\n          </li>\n        ))}\n      </>\n    );\n  }\n}\n\nexport default EditCategoryPageColumns;\n"]},"metadata":{},"sourceType":"module"}