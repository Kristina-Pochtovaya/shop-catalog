{"ast":null,"code":"import _regeneratorRuntime from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import getProducts from'../api/get/getProducts';import getCategories from'../../editCategory/api/get/getCategories';import setImg from'../../../common/untils/setImg';import InputEditProductsCategory from'./InputEditProductsCategoryComponent';import InputEditProductsInStock from'./InputEditProductsInStockComponent';import InputEditProductsName from'./InputEditProductsNameComponent';import InputEditProductsPrice from'./InputEditCategoryPriceComponent';import PopUp from'../../../common/popup/components/PopUpComponent';import PopUpSomethingWentWrong from'../../../common/popup/components/PopUpSomethingWentWrongComponent';import EditProductsImage from'./EditProductsImageComponent';import postDeleteProduct from'../api/post/postDeleteProduct';import postProducts from'../api/post/postProducts';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditProductsPageColumns=/*#__PURE__*/function(_React$Component){_inherits(EditProductsPageColumns,_React$Component);var _super=_createSuper(EditProductsPageColumns);function EditProductsPageColumns(props){var _this;_classCallCheck(this,EditProductsPageColumns);_this=_super.call(this,props);_this.setError=function(errorMessage){return _this.setState({ErrorMessageProducts:errorMessage});};_this.setErrorCategories=function(errorMessage){return _this.setState({ErrorMessageCategories:errorMessage});};_this.setpopupSmthWentWrongActive=function(value){return _this.setState({popupSmthWentWrongActive:value});};_this.setEditActive=function(value){return _this.setState({isEditActive:value});};_this.updateImage=function(value){return _this.setState({productImage:value});};_this.updateProductCategory=function(value,array){return _this.setState({productCategory:value,categoriesArray:array});};_this.updateProductName=function(value){return _this.setState({productName:value});};_this.updateProductPrice=function(value){return _this.setState({productPrice:value});};_this.updateProductInStock=function(value){return _this.setState({productInStock:value});};_this.updateProducts=function(value,valueIsLoading){return _this.setState({productsArray:value,isLoadingProducts:valueIsLoading});};_this.updateDataCategories=function(value,valueIsLoading){return _this.setState({categoriesArray:value.categories,isLoadingCategories:valueIsLoading});};_this.updateAfterDelete=function(){var isUpdated=_this.state.isUpdated;_this.setState({isUpdated:!isUpdated});};_this.state={productsArray:[],isEditActive:false,isEditActiveId:'',isUpdated:false,isLoadingProducts:false,isLoadingCategories:false,ErrorMessageProducts:'',ErrorMessageCategories:'',popupSmthWentWrongActive:true,IsSaveButtonVisible:false,IsEditButtonVisible:true,productImage:'',productCategory:'',productName:'',productPrice:'',productInStock:1,categoriesArray:[]};return _this;}_createClass(EditProductsPageColumns,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getProducts(this.updateProducts,this.setError);case 2:_context.next=4;return getCategories(this.updateDataCategories,this.setErrorCategories);case 4:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(prevProps,prevState){var isUpdated;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isUpdated=this.state.isUpdated;if(!(prevState.isUpdated!==isUpdated)){_context2.next=4;break;}_context2.next=4;return getProducts(this.updateProducts,this.setError);case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidUpdate(_x,_x2){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"handleButtonOnClick\",value:function(){var _handleButtonOnClick=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var _this$state,isEditActiveId,productImage,productCategory,categoriesArray,productName,isUpdated,productPrice,productInStock,_this$props,isProductsUpdated,setIsProductsUpdated;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$state=this.state,isEditActiveId=_this$state.isEditActiveId,productImage=_this$state.productImage,productCategory=_this$state.productCategory,categoriesArray=_this$state.categoriesArray,productName=_this$state.productName,isUpdated=_this$state.isUpdated,productPrice=_this$state.productPrice,productInStock=_this$state.productInStock;_this$props=this.props,isProductsUpdated=_this$props.isProductsUpdated,setIsProductsUpdated=_this$props.setIsProductsUpdated;_context3.next=4;return postProducts(isEditActiveId,productImage,productCategory,categoriesArray,productName,productPrice,productInStock);case 4:this.setState({isUpdated:!isUpdated});isProductsUpdated?setIsProductsUpdated(false):setIsProductsUpdated(true);case 6:case\"end\":return _context3.stop();}}},_callee3,this);}));function handleButtonOnClick(_x3){return _handleButtonOnClick.apply(this,arguments);}return handleButtonOnClick;}()},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,isEditActive=_this$state2.isEditActive,isEditActiveId=_this$state2.isEditActiveId,ErrorMessageProducts=_this$state2.ErrorMessageProducts,popupSmthWentWrongActive=_this$state2.popupSmthWentWrongActive,productsArray=_this$state2.productsArray,isLoadingProducts=_this$state2.isLoadingProducts,IsSaveButtonVisible=_this$state2.IsSaveButtonVisible,IsEditButtonVisible=_this$state2.IsEditButtonVisible,isLoadingCategories=_this$state2.isLoadingCategories,ErrorMessageCategories=_this$state2.ErrorMessageCategories,isUpdated=_this$state2.isUpdated;var _this$props2=this.props,isProductsUpdated=_this$props2.isProductsUpdated,setIsProductsUpdated=_this$props2.setIsProductsUpdated;if(!isLoadingProducts||!isLoadingCategories){return/*#__PURE__*/_jsx(\"div\",{className:\"-isLoading\",children:\" \"});}if(ErrorMessageProducts||ErrorMessageCategories){return/*#__PURE__*/_jsx(PopUp,{active:popupSmthWentWrongActive,setActive:this.setpopupSmthWentWrongActive,children:/*#__PURE__*/_jsx(PopUpSomethingWentWrong,{text:\"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0435\\u0449\\u0435 \\u0440\\u0430\\u0437\",setpopupSmthWentWrongActive:this.setpopupSmthWentWrongActive})});}return/*#__PURE__*/_jsx(_Fragment,{children:productsArray.products.map(function(product){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"columnImage\",children:(isEditActive&&product.id)!==isEditActiveId?/*#__PURE__*/_jsx(_Fragment,{children:product.image?/*#__PURE__*/_jsx(\"img\",{className:\"imageProducts\",src:product.image,alt:product.imgAlt,title:product.imgTitle}):/*#__PURE__*/_jsx(\"img\",{src:setImg(product.description),alt:product.imgAlt,title:product.imgTitle})}):/*#__PURE__*/_jsx(EditProductsImage,{id:product.id,description:product.description,updateImage:_this2.updateImage})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnCategory\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsCategory,{category:product.category,categoryId:product.categoryId,updateProductCategory:_this2.updateProductCategory}):/*#__PURE__*/_jsx(\"p\",{children:product.category})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnName\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsName,{description:product.description,updateProductName:_this2.updateProductName}):/*#__PURE__*/_jsx(\"p\",{children:product.description})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnPrice\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsPrice,{price:product.price,updateProductPrice:_this2.updateProductPrice}):/*#__PURE__*/_jsx(\"p\",{children:product.price})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnInStock\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsInStock,{inStock:product.inStock,updateProductInStock:_this2.updateProductInStock}):/*#__PURE__*/_jsx(\"p\",{className:\"inStockString\",children:Number(product.inStock)===1?'да':'нет'})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnEdit\",children:IsEditButtonVisible&&isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"editProductsButton\",onClick:function onClick(){_this2.setState({isEditActive:false,isEditActiveId:product.id,IsSaveButtonVisible:true,IsEditButtonVisible:false});_this2.handleButtonOnClick();},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}):/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"editProductsButton\",onClick:function onClick(){_this2.setState({isEditActive:true,isEditActiveId:product.id,productImage:product.image,productCategory:product.category,productName:product.description,productPrice:product.price,productInStock:product.inStock,IsEditButtonVisible:true,IsSaveButtonVisible:false});},children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnDelete\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"deleteProductsButton\",onClick:function onClick(){postDeleteProduct(product.id,setIsProductsUpdated,isProductsUpdated,_this2.updateAfterDelete);},children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]})},product.id);})});}}]);return EditProductsPageColumns;}(React.Component);export default EditProductsPageColumns;","map":{"version":3,"sources":["/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/src/pages/editProducts/components/EditProductsPageColumnsComponent.jsx"],"names":["React","getProducts","getCategories","setImg","InputEditProductsCategory","InputEditProductsInStock","InputEditProductsName","InputEditProductsPrice","PopUp","PopUpSomethingWentWrong","EditProductsImage","postDeleteProduct","postProducts","EditProductsPageColumns","props","setError","errorMessage","setState","ErrorMessageProducts","setErrorCategories","ErrorMessageCategories","setpopupSmthWentWrongActive","value","popupSmthWentWrongActive","setEditActive","isEditActive","updateImage","productImage","updateProductCategory","array","productCategory","categoriesArray","updateProductName","productName","updateProductPrice","productPrice","updateProductInStock","productInStock","updateProducts","valueIsLoading","productsArray","isLoadingProducts","updateDataCategories","categories","isLoadingCategories","updateAfterDelete","isUpdated","state","isEditActiveId","IsSaveButtonVisible","IsEditButtonVisible","prevProps","prevState","e","isProductsUpdated","setIsProductsUpdated","products","map","product","id","image","imgAlt","imgTitle","description","category","categoryId","price","inStock","Number","handleButtonOnClick","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport getProducts from '../api/get/getProducts';\nimport getCategories from '../../editCategory/api/get/getCategories';\nimport setImg from '../../../common/untils/setImg';\nimport InputEditProductsCategory from './InputEditProductsCategoryComponent';\nimport InputEditProductsInStock from './InputEditProductsInStockComponent';\nimport InputEditProductsName from './InputEditProductsNameComponent';\nimport InputEditProductsPrice from './InputEditCategoryPriceComponent';\nimport PopUp from '../../../common/popup/components/PopUpComponent';\nimport PopUpSomethingWentWrong from '../../../common/popup/components/PopUpSomethingWentWrongComponent';\nimport EditProductsImage from './EditProductsImageComponent';\nimport postDeleteProduct from '../api/post/postDeleteProduct';\nimport postProducts from '../api/post/postProducts';\n\nclass EditProductsPageColumns extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productsArray: [],\n      isEditActive: false,\n      isEditActiveId: '',\n      isUpdated: false,\n      isLoadingProducts: false,\n      isLoadingCategories: false,\n      ErrorMessageProducts: '',\n      ErrorMessageCategories: '',\n      popupSmthWentWrongActive: true,\n      IsSaveButtonVisible: false,\n      IsEditButtonVisible: true,\n      productImage: '',\n      productCategory: '',\n      productName: '',\n      productPrice: '',\n      productInStock: 1,\n      categoriesArray: [],\n    };\n  }\n\n  async componentDidMount() {\n    await getProducts(this.updateProducts, this.setError);\n    await getCategories(this.updateDataCategories, this.setErrorCategories);\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    const { isUpdated } = this.state;\n    if (prevState.isUpdated !== isUpdated) {\n      await getProducts(this.updateProducts, this.setError);\n    }\n  }\n\n  async handleButtonOnClick(e) {\n    const {\n      isEditActiveId, productImage, productCategory, categoriesArray, productName, isUpdated,\n      productPrice, productInStock,\n    } = this.state;\n    const { isProductsUpdated, setIsProductsUpdated } = this.props;\n    await postProducts(\n      isEditActiveId, productImage, productCategory, categoriesArray, productName, productPrice,\n      productInStock,\n    );\n    this.setState({\n      isUpdated: !isUpdated,\n    });\n    isProductsUpdated ? setIsProductsUpdated(false) : setIsProductsUpdated(true);\n  }\n\n  setError = (errorMessage) => this.setState({ ErrorMessageProducts: errorMessage });\n\n  setErrorCategories = (errorMessage) => this.setState({ ErrorMessageCategories: errorMessage });\n\n  setpopupSmthWentWrongActive = (value) => this.setState({ popupSmthWentWrongActive: value });\n\n  setEditActive = (value) => this.setState({ isEditActive: value });\n\n  updateImage = (value) => this.setState({ productImage: value });\n\n  updateProductCategory = (value, array) => this.setState({\n    productCategory: value, categoriesArray: array,\n  });\n\n  updateProductName = (value) => this.setState({ productName: value });\n\n  updateProductPrice = (value) => this.setState({ productPrice: value });\n\n  updateProductInStock = (value) => this.setState({ productInStock: value });\n\n  updateProducts = (value, valueIsLoading) => this.setState({\n    productsArray: value,\n    isLoadingProducts: valueIsLoading,\n  });\n\n  updateDataCategories = (value, valueIsLoading) => this.setState({\n    categoriesArray: value.categories,\n    isLoadingCategories: valueIsLoading,\n  });\n\n  updateAfterDelete = () => {\n    const { isUpdated } = this.state;\n    this.setState({ isUpdated: !isUpdated });\n  }\n\n  render() {\n    const {\n      isEditActive, isEditActiveId, ErrorMessageProducts, popupSmthWentWrongActive,\n      productsArray, isLoadingProducts, IsSaveButtonVisible, IsEditButtonVisible,\n      isLoadingCategories, ErrorMessageCategories, isUpdated,\n    } = this.state;\n\n    const { isProductsUpdated, setIsProductsUpdated } = this.props;\n    if (!isLoadingProducts || !isLoadingCategories) {\n      return <div className=\"-isLoading\"> </div>;\n    }\n    if (ErrorMessageProducts || ErrorMessageCategories) {\n      return (\n        <PopUp\n          active={popupSmthWentWrongActive}\n          setActive={this.setpopupSmthWentWrongActive}\n        >\n          <PopUpSomethingWentWrong\n            text=\"Попробуйте еще раз\"\n            setpopupSmthWentWrongActive={this.setpopupSmthWentWrongActive}\n          />\n        </PopUp>\n      );\n    }\n    return (\n      <>\n        {productsArray.products.map((product) => (\n          <li key={product.id}>\n            <div className=\"columns\">\n              <div className=\"columnImage\">\n                {(isEditActive && product.id) !== isEditActiveId\n                  ? (\n                    <>\n                      {product.image\n                        ? (\n                          <img\n                            className=\"imageProducts\"\n                            src={product.image}\n                            alt={product.imgAlt}\n                            title={product.imgTitle}\n                          />\n                        ) : (\n                          <img\n                            src={setImg(product.description)}\n                            alt={product.imgAlt}\n                            title={product.imgTitle}\n                          />\n                        )}\n                    </>\n                  ) : (\n                    <EditProductsImage\n                      id={product.id}\n                      description={product.description}\n                      updateImage={this.updateImage}\n                    />\n                  )}\n              </div>\n              <div className=\"columnCategory\">\n                {isEditActive && product.id === isEditActiveId\n                  ? (\n                    <InputEditProductsCategory\n                      category={product.category}\n                      categoryId={product.categoryId}\n                      updateProductCategory={this.updateProductCategory}\n                    />\n                  ) : <p>{product.category}</p>}\n              </div>\n              <div className=\"columnName\">\n                {isEditActive && product.id === isEditActiveId\n                  ? (\n                    <InputEditProductsName\n                      description={product.description}\n                      updateProductName={this.updateProductName}\n                    />\n                  ) : <p>{product.description}</p>}\n              </div>\n              <div className=\"columnPrice\">\n                {isEditActive && product.id === isEditActiveId\n                  ? (\n                    <InputEditProductsPrice\n                      price={product.price}\n                      updateProductPrice={this.updateProductPrice}\n                    />\n                  ) : <p>{product.price}</p>}\n              </div>\n              <div className=\"columnInStock\">\n                {isEditActive && product.id === isEditActiveId\n                  ? (\n                    <InputEditProductsInStock\n                      inStock={product.inStock}\n                      updateProductInStock={this.updateProductInStock}\n                    />\n                  ) : <p className=\"inStockString\">{Number(product.inStock) === 1 ? 'да' : 'нет'}</p>}\n              </div>\n              <div className=\"columnEdit\">\n                {IsEditButtonVisible && isEditActive && product.id === isEditActiveId ? (\n                  <button\n                    type=\"button\"\n                    className=\"editProductsButton\"\n                    onClick={() => {\n                      this.setState({\n                        isEditActive: false,\n                        isEditActiveId: product.id,\n                        IsSaveButtonVisible: true,\n                        IsEditButtonVisible: false,\n                      });\n                      this.handleButtonOnClick();\n                    }}\n                  >\n                    Сохранить\n                  </button>\n                ) : (\n                  <button\n                    type=\"button\"\n                    className=\"editProductsButton\"\n                    onClick={() => {\n                      this.setState({\n                        isEditActive: true,\n                        isEditActiveId: product.id,\n                        productImage: product.image,\n                        productCategory: product.category,\n                        productName: product.description,\n                        productPrice: product.price,\n                        productInStock: product.inStock,\n                        IsEditButtonVisible: true,\n                        IsSaveButtonVisible: false,\n                      });\n                    }}\n                  >\n                    Изменить\n                  </button>\n                )}\n              </div>\n              <div className=\"columnDelete\">\n                <button\n                  type=\"button\"\n                  className=\"deleteProductsButton\"\n                  onClick={() => {\n                    postDeleteProduct(product.id, setIsProductsUpdated,\n                      isProductsUpdated, this.updateAfterDelete);\n                  }}\n                >\n                  Удалить\n                </button>\n              </div>\n            </div>\n          </li>\n        ))}\n      </>\n    );\n  }\n}\n\nexport default EditProductsPageColumns;\n"]},"metadata":{},"sourceType":"module"}