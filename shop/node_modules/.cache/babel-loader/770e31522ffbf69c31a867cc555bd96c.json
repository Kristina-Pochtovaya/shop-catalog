{"ast":null,"code":"import _regeneratorRuntime from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/destructuring-assignment */import React from'react';import{Link}from'react-router-dom';import Header from'../../main/header/components/HeaderComponent';import Footer from'../../main/footer/components/FooterComponent';import getProducts from'../api/get/getProducts';import setImg from'../../../common/untils/setImg';import InputEditProductsCategory from'./InputEditProductsCategoryComponent';import InputEditProductsInStock from'./InputEditProductsInStockComponent';import InputEditProductsName from'./InputEditProductsNameComponent';import InputEditProductsPrice from'./InputEditCategoryPriceComponent';import PopUp from'../../../common/popup/components/PopUpComponent';import PopUpSomethingWentWrong from'../../../common/popup/components/PopUpSomethingWentWrongComponent';import EditProductsImage from'./EditProductsImageComponent';import postDeleteCategory from'../api/post/postDeleteCategory';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var EditProductsPage=/*#__PURE__*/function(_React$Component){_inherits(EditProductsPage,_React$Component);var _super=_createSuper(EditProductsPage);function EditProductsPage(props){var _this;_classCallCheck(this,EditProductsPage);_this=_super.call(this,props);_this.state={productsArray:[],isEditActive:false,isEditActiveId:'',isLoadingProducts:false,ErrorMessageProducts:'',popupSmthWentWrongActive:true};_this.updateProducts=_this.updateProducts.bind(_assertThisInitialized(_this));_this.setError=_this.setError.bind(_assertThisInitialized(_this));_this.setpopupSmthWentWrongActive=_this.setpopupSmthWentWrongActive.bind(_assertThisInitialized(_this));_this.setEditActive=_this.setEditActive.bind(_assertThisInitialized(_this));return _this;}_createClass(EditProductsPage,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.interval=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getProducts(_this2.updateProducts,_this2.setError);case 2:case\"end\":return _context.stop();}}},_callee);})),10);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this3=this;if(prevState.isEditActiveId!==this.state.isEditActiveId){this.interval=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getProducts(_this3.updateProducts,_this3.setError);case 2:case\"end\":return _context2.stop();}}},_callee2);})),100);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearTimeout(this.interval);}},{key:\"setError\",value:function setError(errorMessage){this.setState({ErrorMessageProducts:errorMessage});}},{key:\"setpopupSmthWentWrongActive\",value:function setpopupSmthWentWrongActive(value){this.setState({popupSmthWentWrongActive:value});}},{key:\"setEditActive\",value:function setEditActive(value){this.setState({isEditActive:value});}},{key:\"updateProducts\",value:function updateProducts(value,valueIsLoading){this.setState({productsArray:value,isLoadingProducts:valueIsLoading});}},{key:\"render\",value:function render(){var _this4=this;var _this$state=this.state,isEditActive=_this$state.isEditActive,isEditActiveId=_this$state.isEditActiveId,ErrorMessageProducts=_this$state.ErrorMessageProducts,popupSmthWentWrongActive=_this$state.popupSmthWentWrongActive,productsArray=_this$state.productsArray,isLoadingProducts=_this$state.isLoadingProducts;if(!isLoadingProducts){return/*#__PURE__*/_jsx(\"div\",{className:\"-isLoading\",children:\" \"});}if(ErrorMessageProducts){return/*#__PURE__*/_jsx(PopUp,{active:popupSmthWentWrongActive,setActive:this.setpopupSmthWentWrongActive,children:/*#__PURE__*/_jsx(PopUpSomethingWentWrong,{text:\"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0435\\u0449\\u0435 \\u0440\\u0430\\u0437\",setpopupSmthWentWrongActive:this.setpopupSmthWentWrongActive})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{linkItem:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"buttonBack\",children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"}),link:\"/personal\",disabled:false}),/*#__PURE__*/_jsxs(\"div\",{className:\"editProducts-box\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"personalAccount\",children:\" \\u0422\\u043E\\u0432\\u0430\\u0440\\u044B \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"editProducts-table\",children:[/*#__PURE__*/_jsx(Link,{to:\"/add-product\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"addNewProductButton\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440\"})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"listOrder-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"titleImage\",children:\"\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"p\",{className:\"titleName\",children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"titleName\",children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"p\",{className:\"titlePrice\",children:\"\\u0426\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"p\",{className:\"titleInStock\",children:\"\\u0412 \\u043D\\u0430\\u043B\\u0438\\u0447\\u0438\\u0438\"}),/*#__PURE__*/_jsx(\"p\",{className:\"titleEdit\",children:\" \"}),/*#__PURE__*/_jsx(\"p\",{className:\"titleDelete\",children:\" \"})]}),productsArray.products.map(function(product){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"columnImage\",children:(isEditActive&&product.id)!==isEditActiveId?/*#__PURE__*/_jsx(_Fragment,{children:product.image?/*#__PURE__*/_jsx(\"img\",{className:\"imageProducts\",src:product.image,alt:product.imgAlt,title:product.imgTitle}):/*#__PURE__*/_jsx(\"img\",{src:setImg(product.description),alt:product.imgAlt,title:product.imgTitle})}):/*#__PURE__*/_jsx(EditProductsImage,{id:product.id,description:product.description})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnCategory\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsCategory,{id:product.id,category:product.category,categoryId:product.categoryId,setEditActive:_this4.setEditActive,setIsProductsUpdated:_this4.props.setIsProductsUpdated,isProductsUpdated:_this4.props.isProductsUpdated}):/*#__PURE__*/_jsx(\"p\",{children:product.category})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnName\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsName,{id:product.id,description:product.description,setEditActive:_this4.setEditActive,setIsProductsUpdated:_this4.props.setIsProductsUpdated,isProductsUpdated:_this4.props.isProductsUpdated}):/*#__PURE__*/_jsx(\"p\",{children:product.description})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnPrice\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsPrice,{id:product.id,price:product.price,setEditActive:_this4.setEditActive,setIsProductsUpdated:_this4.props.setIsProductsUpdated,isProductsUpdated:_this4.props.isProductsUpdated}):/*#__PURE__*/_jsx(\"p\",{children:product.price})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnInStock\",children:isEditActive&&product.id===isEditActiveId?/*#__PURE__*/_jsx(InputEditProductsInStock,{id:product.id,inStock:product.inStock,setEditActive:_this4.setEditActive,setIsProductsUpdated:_this4.props.setIsProductsUpdated,isProductsUpdated:_this4.props.isProductsUpdated}):/*#__PURE__*/_jsx(\"p\",{className:\"inStockString\",children:Number(product.inStock)===1?'да':'нет'})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnEdit\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"editProductsButton\",onClick:function onClick(){_this4.setState({isEditActive:true,isEditActiveId:product.id});_this4.props.isProductsUpdated?_this4.props.setIsProductsUpdated(false):_this4.props.setIsProductsUpdated(true);},children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"columnDelete\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"deleteProductsButton\",onClick:function onClick(){_this4.setState({isEditActive:true,isEditActiveId:product.id});postDeleteCategory(product.id);},children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]})},product.id);})]})]})]}),/*#__PURE__*/_jsx(Footer,{})]});}}]);return EditProductsPage;}(React.Component);export default EditProductsPage;","map":{"version":3,"sources":["/home/ITRANSITION.CORP/k.pochtovaya/Documents/React Projects/shop catalog/shop/shop/src/pages/editProducts/components/EditProductsPageComponent.jsx"],"names":["React","Link","Header","Footer","getProducts","setImg","InputEditProductsCategory","InputEditProductsInStock","InputEditProductsName","InputEditProductsPrice","PopUp","PopUpSomethingWentWrong","EditProductsImage","postDeleteCategory","EditProductsPage","props","state","productsArray","isEditActive","isEditActiveId","isLoadingProducts","ErrorMessageProducts","popupSmthWentWrongActive","updateProducts","bind","setError","setpopupSmthWentWrongActive","setEditActive","interval","setTimeout","prevProps","prevState","clearTimeout","errorMessage","setState","value","valueIsLoading","products","map","product","id","image","imgAlt","imgTitle","description","category","categoryId","setIsProductsUpdated","isProductsUpdated","price","inStock","Number","Component"],"mappings":"m4CAAA,mDACA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,8CAAnB,CACA,MAAOC,CAAAA,MAAP,KAAmB,8CAAnB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,+BAAnB,CACA,MAAOC,CAAAA,yBAAP,KAAsC,sCAAtC,CACA,MAAOC,CAAAA,wBAAP,KAAqC,qCAArC,CACA,MAAOC,CAAAA,qBAAP,KAAkC,kCAAlC,CACA,MAAOC,CAAAA,sBAAP,KAAmC,mCAAnC,CACA,MAAOC,CAAAA,KAAP,KAAkB,iDAAlB,CACA,MAAOC,CAAAA,uBAAP,KAAoC,mEAApC,CACA,MAAOC,CAAAA,iBAAP,KAA8B,8BAA9B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,gCAA/B,C,gJAEMC,CAAAA,gB,gIACJ,0BAAYC,KAAZ,CAAmB,kDACjB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACXC,aAAa,CAAE,EADJ,CAEXC,YAAY,CAAE,KAFH,CAGXC,cAAc,CAAE,EAHL,CAIXC,iBAAiB,CAAE,KAJR,CAKXC,oBAAoB,CAAE,EALX,CAMXC,wBAAwB,CAAE,IANf,CAAb,CAQA,MAAKC,cAAL,CAAsB,MAAKA,cAAL,CAAoBC,IAApB,+BAAtB,CACA,MAAKC,QAAL,CAAgB,MAAKA,QAAL,CAAcD,IAAd,+BAAhB,CACA,MAAKE,2BAAL,CAAmC,MAAKA,2BAAL,CAAiCF,IAAjC,+BAAnC,CACA,MAAKG,aAAL,CAAqB,MAAKA,aAAL,CAAmBH,IAAnB,+BAArB,CAbiB,aAclB,C,8DAED,4BAAoB,iBAClB,KAAKI,QAAL,CAAgBC,UAAU,sEAAC,yJACnBzB,CAAAA,WAAW,CAAC,MAAI,CAACmB,cAAN,CAAsB,MAAI,CAACE,QAA3B,CADQ,uDAAD,GAEvB,EAFuB,CAA1B,CAGD,C,kCAED,4BAAmBK,SAAnB,CAA8BC,SAA9B,CAAyC,iBACvC,GAAIA,SAAS,CAACZ,cAAV,GAA6B,KAAKH,KAAL,CAAWG,cAA5C,CAA4D,CAC1D,KAAKS,QAAL,CAAgBC,UAAU,sEAAC,+JACnBzB,CAAAA,WAAW,CAAC,MAAI,CAACmB,cAAN,CAAsB,MAAI,CAACE,QAA3B,CADQ,yDAAD,GAEvB,GAFuB,CAA1B,CAGD,CACF,C,oCAED,+BAAuB,CACrBO,YAAY,CAAC,KAAKJ,QAAN,CAAZ,CACD,C,wBAED,kBAASK,YAAT,CAAuB,CACrB,KAAKC,QAAL,CAAc,CACZb,oBAAoB,CAAEY,YADV,CAAd,EAGD,C,2CAED,qCAA4BE,KAA5B,CAAmC,CACjC,KAAKD,QAAL,CAAc,CACZZ,wBAAwB,CAAEa,KADd,CAAd,EAGD,C,6BAED,uBAAcA,KAAd,CAAqB,CACnB,KAAKD,QAAL,CAAc,CACZhB,YAAY,CAAEiB,KADF,CAAd,EAGD,C,8BAED,wBAAeA,KAAf,CAAsBC,cAAtB,CAAsC,CACpC,KAAKF,QAAL,CAAc,CACZjB,aAAa,CAAEkB,KADH,CAEZf,iBAAiB,CAAEgB,cAFP,CAAd,EAID,C,sBAED,iBAAS,iCAKH,KAAKpB,KALF,CAELE,YAFK,aAELA,YAFK,CAESC,cAFT,aAESA,cAFT,CAGLE,oBAHK,aAGLA,oBAHK,CAGiBC,wBAHjB,aAGiBA,wBAHjB,CAILL,aAJK,aAILA,aAJK,CAIUG,iBAJV,aAIUA,iBAJV,CAOP,GAAI,CAACA,iBAAL,CAAwB,CACtB,mBAAO,YAAK,SAAS,CAAC,YAAf,eAAP,CACD,CACD,GAAIC,oBAAJ,CAA0B,CACxB,mBACE,KAAC,KAAD,EACE,MAAM,CAAEC,wBADV,CAEE,SAAS,CAAE,KAAKI,2BAFlB,uBAIE,KAAC,uBAAD,EACE,IAAI,CAAC,oGADP,CAEE,2BAA2B,CAAE,KAAKA,2BAFpC,EAJF,EADF,CAWD,CACD,mBACE,wCACE,KAAC,MAAD,EAAQ,QAAQ,cAAE,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,YAAhC,4CAAlB,CAA+E,IAAI,CAAC,WAApF,CAAgG,QAAQ,CAAE,KAA1G,EADF,cAEE,aAAK,SAAS,CAAC,kBAAf,wBACE,WAAI,SAAS,CAAC,iBAAd,oDADF,cAEE,aAAK,SAAS,CAAC,oBAAf,wBACE,KAAC,IAAD,EAAM,EAAE,CAAC,cAAT,uBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,qBAFZ,6FADF,EADF,cASE,YAAI,SAAS,CAAC,gBAAd,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,UAAG,SAAS,CAAC,YAAb,gFADF,cAEE,UAAG,SAAS,CAAC,WAAb,oEAFF,cAGE,UAAG,SAAS,CAAC,WAAb,8DAHF,cAIE,UAAG,SAAS,CAAC,YAAb,sCAJF,cAKE,UAAG,SAAS,CAAC,cAAb,+DALF,cASE,UAAG,SAAS,CAAC,WAAb,eATF,cAUE,UAAG,SAAS,CAAC,aAAb,eAVF,GADF,CAaGT,aAAa,CAACoB,QAAd,CAAuBC,GAAvB,CAA2B,SAACC,OAAD,qBAC1B,iCACE,aAAK,SAAS,CAAC,SAAf,wBACE,YAAK,SAAS,CAAC,aAAf,UACG,CAACrB,YAAY,EAAIqB,OAAO,CAACC,EAAzB,IAAiCrB,cAAjC,cAEG,yBACGoB,OAAO,CAACE,KAAR,cAEG,YACE,SAAS,CAAC,eADZ,CAEE,GAAG,CAAEF,OAAO,CAACE,KAFf,CAGE,GAAG,CAAEF,OAAO,CAACG,MAHf,CAIE,KAAK,CAAEH,OAAO,CAACI,QAJjB,EAFH,cAUG,YACE,GAAG,CAAEtC,MAAM,CAACkC,OAAO,CAACK,WAAT,CADb,CAEE,GAAG,CAAEL,OAAO,CAACG,MAFf,CAGE,KAAK,CAAEH,OAAO,CAACI,QAHjB,EAXN,EAFH,cAsBG,KAAC,iBAAD,EACE,EAAE,CAAEJ,OAAO,CAACC,EADd,CAEE,WAAW,CAAED,OAAO,CAACK,WAFvB,EAvBN,EADF,cA+BE,YAAK,SAAS,CAAC,gBAAf,UACG1B,YAAY,EAAIqB,OAAO,CAACC,EAAR,GAAerB,cAA/B,cAEG,KAAC,yBAAD,EACE,EAAE,CAAEoB,OAAO,CAACC,EADd,CAEE,QAAQ,CAAED,OAAO,CAACM,QAFpB,CAGE,UAAU,CAAEN,OAAO,CAACO,UAHtB,CAIE,aAAa,CAAE,MAAI,CAACnB,aAJtB,CAKE,oBAAoB,CAAE,MAAI,CAACZ,KAAL,CAAWgC,oBALnC,CAME,iBAAiB,CAAE,MAAI,CAAChC,KAAL,CAAWiC,iBANhC,EAFH,cAWG,mBAAIT,OAAO,CAACM,QAAZ,EAZN,EA/BF,cA8CE,YAAK,SAAS,CAAC,YAAf,UACG3B,YAAY,EAAIqB,OAAO,CAACC,EAAR,GAAerB,cAA/B,cAEG,KAAC,qBAAD,EACE,EAAE,CAAEoB,OAAO,CAACC,EADd,CAEE,WAAW,CAAED,OAAO,CAACK,WAFvB,CAGE,aAAa,CAAE,MAAI,CAACjB,aAHtB,CAIE,oBAAoB,CAAE,MAAI,CAACZ,KAAL,CAAWgC,oBAJnC,CAKE,iBAAiB,CAAE,MAAI,CAAChC,KAAL,CAAWiC,iBALhC,EAFH,cAUG,mBAAIT,OAAO,CAACK,WAAZ,EAXN,EA9CF,cA4DE,YAAK,SAAS,CAAC,aAAf,UACG1B,YAAY,EAAIqB,OAAO,CAACC,EAAR,GAAerB,cAA/B,cAEG,KAAC,sBAAD,EACE,EAAE,CAAEoB,OAAO,CAACC,EADd,CAEE,KAAK,CAAED,OAAO,CAACU,KAFjB,CAGE,aAAa,CAAE,MAAI,CAACtB,aAHtB,CAIE,oBAAoB,CAAE,MAAI,CAACZ,KAAL,CAAWgC,oBAJnC,CAKE,iBAAiB,CAAE,MAAI,CAAChC,KAAL,CAAWiC,iBALhC,EAFH,cAUG,mBAAIT,OAAO,CAACU,KAAZ,EAXN,EA5DF,cA0EE,YAAK,SAAS,CAAC,eAAf,UACG/B,YAAY,EAAIqB,OAAO,CAACC,EAAR,GAAerB,cAA/B,cAEG,KAAC,wBAAD,EACE,EAAE,CAAEoB,OAAO,CAACC,EADd,CAEE,OAAO,CAAED,OAAO,CAACW,OAFnB,CAGE,aAAa,CAAE,MAAI,CAACvB,aAHtB,CAIE,oBAAoB,CAAE,MAAI,CAACZ,KAAL,CAAWgC,oBAJnC,CAKE,iBAAiB,CAAE,MAAI,CAAChC,KAAL,CAAWiC,iBALhC,EAFH,cAUG,UAAG,SAAS,CAAC,eAAb,UAA8BG,MAAM,CAACZ,OAAO,CAACW,OAAT,CAAN,GAA4B,CAA5B,CAAgC,IAAhC,CAAuC,KAArE,EAXN,EA1EF,cAwFE,YAAK,SAAS,CAAC,YAAf,uBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,oBAFZ,CAGE,OAAO,CAAE,kBAAM,CACb,MAAI,CAAChB,QAAL,CAAc,CACZhB,YAAY,CAAE,IADF,CAEZC,cAAc,CAAEoB,OAAO,CAACC,EAFZ,CAAd,EAIA,MAAI,CAACzB,KAAL,CAAWiC,iBAAX,CACI,MAAI,CAACjC,KAAL,CAAWgC,oBAAX,CAAgC,KAAhC,CADJ,CAEI,MAAI,CAAChC,KAAL,CAAWgC,oBAAX,CAAgC,IAAhC,CAFJ,CAGD,CAXH,4FADF,EAxFF,cA0GE,YAAK,SAAS,CAAC,cAAf,uBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,sBAFZ,CAGE,OAAO,CAAE,kBAAM,CACb,MAAI,CAACb,QAAL,CAAc,CACZhB,YAAY,CAAE,IADF,CAEZC,cAAc,CAAEoB,OAAO,CAACC,EAFZ,CAAd,EAIA3B,kBAAkB,CAAC0B,OAAO,CAACC,EAAT,CAAlB,CACD,CATH,wDADF,EA1GF,GADF,EAASD,OAAO,CAACC,EAAjB,CAD0B,EAA3B,CAbH,GATF,GAFF,GAFF,cA2JE,KAAC,MAAD,IA3JF,GADF,CA+JD,C,8BAlP4BxC,KAAK,CAACoD,S,EAqPrC,cAAetC,CAAAA,gBAAf","sourcesContent":["/* eslint-disable react/destructuring-assignment */\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport Header from '../../main/header/components/HeaderComponent';\nimport Footer from '../../main/footer/components/FooterComponent';\nimport getProducts from '../api/get/getProducts';\nimport setImg from '../../../common/untils/setImg';\nimport InputEditProductsCategory from './InputEditProductsCategoryComponent';\nimport InputEditProductsInStock from './InputEditProductsInStockComponent';\nimport InputEditProductsName from './InputEditProductsNameComponent';\nimport InputEditProductsPrice from './InputEditCategoryPriceComponent';\nimport PopUp from '../../../common/popup/components/PopUpComponent';\nimport PopUpSomethingWentWrong from '../../../common/popup/components/PopUpSomethingWentWrongComponent';\nimport EditProductsImage from './EditProductsImageComponent';\nimport postDeleteCategory from '../api/post/postDeleteCategory';\n\nclass EditProductsPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productsArray: [],\n      isEditActive: false,\n      isEditActiveId: '',\n      isLoadingProducts: false,\n      ErrorMessageProducts: '',\n      popupSmthWentWrongActive: true,\n    };\n    this.updateProducts = this.updateProducts.bind(this);\n    this.setError = this.setError.bind(this);\n    this.setpopupSmthWentWrongActive = this.setpopupSmthWentWrongActive.bind(this);\n    this.setEditActive = this.setEditActive.bind(this);\n  }\n\n  componentDidMount() {\n    this.interval = setTimeout(async () => {\n      await getProducts(this.updateProducts, this.setError);\n    }, 10);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.isEditActiveId !== this.state.isEditActiveId) {\n      this.interval = setTimeout(async () => {\n        await getProducts(this.updateProducts, this.setError);\n      }, 100);\n    }\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.interval);\n  }\n\n  setError(errorMessage) {\n    this.setState({\n      ErrorMessageProducts: errorMessage,\n    });\n  }\n\n  setpopupSmthWentWrongActive(value) {\n    this.setState({\n      popupSmthWentWrongActive: value,\n    });\n  }\n\n  setEditActive(value) {\n    this.setState({\n      isEditActive: value,\n    });\n  }\n\n  updateProducts(value, valueIsLoading) {\n    this.setState({\n      productsArray: value,\n      isLoadingProducts: valueIsLoading,\n    });\n  }\n\n  render() {\n    const {\n      isEditActive, isEditActiveId,\n      ErrorMessageProducts, popupSmthWentWrongActive,\n      productsArray, isLoadingProducts,\n    } = this.state;\n\n    if (!isLoadingProducts) {\n      return <div className=\"-isLoading\"> </div>;\n    }\n    if (ErrorMessageProducts) {\n      return (\n        <PopUp\n          active={popupSmthWentWrongActive}\n          setActive={this.setpopupSmthWentWrongActive}\n        >\n          <PopUpSomethingWentWrong\n            text=\"Попробуйте еще раз\"\n            setpopupSmthWentWrongActive={this.setpopupSmthWentWrongActive}\n          />\n        </PopUp>\n      );\n    }\n    return (\n      <>\n        <Header linkItem={<button type=\"button\" className=\"buttonBack\">Назад</button>} link=\"/personal\" disabled={false} />\n        <div className=\"editProducts-box\">\n          <h1 className=\"personalAccount\"> Товары </h1>\n          <div className=\"editProducts-table\">\n            <Link to=\"/add-product\">\n              <button\n                type=\"button\"\n                className=\"addNewProductButton\"\n              >\n                Добавить товар\n              </button>\n            </Link>\n            <ul className=\"listOrder-wrap\">\n              <div className=\"title\">\n                <p className=\"titleImage\">Изображение</p>\n                <p className=\"titleName\">Категория</p>\n                <p className=\"titleName\">Название</p>\n                <p className=\"titlePrice\">Цена</p>\n                <p className=\"titleInStock\">\n                  В\n                  наличии\n                </p>\n                <p className=\"titleEdit\"> </p>\n                <p className=\"titleDelete\"> </p>\n              </div>\n              {productsArray.products.map((product) => (\n                <li key={product.id}>\n                  <div className=\"columns\">\n                    <div className=\"columnImage\">\n                      {(isEditActive && product.id) !== isEditActiveId\n                        ? (\n                          <>\n                            {product.image\n                              ? (\n                                <img\n                                  className=\"imageProducts\"\n                                  src={product.image}\n                                  alt={product.imgAlt}\n                                  title={product.imgTitle}\n                                />\n                              )\n                              : (\n                                <img\n                                  src={setImg(product.description)}\n                                  alt={product.imgAlt}\n                                  title={product.imgTitle}\n                                />\n                              )}\n                          </>\n                        )\n                        : (\n                          <EditProductsImage\n                            id={product.id}\n                            description={product.description}\n                          />\n                        )}\n                    </div>\n\n                    <div className=\"columnCategory\">\n                      {isEditActive && product.id === isEditActiveId\n                        ? (\n                          <InputEditProductsCategory\n                            id={product.id}\n                            category={product.category}\n                            categoryId={product.categoryId}\n                            setEditActive={this.setEditActive}\n                            setIsProductsUpdated={this.props.setIsProductsUpdated}\n                            isProductsUpdated={this.props.isProductsUpdated}\n                          />\n                        )\n                        : <p>{product.category}</p>}\n                    </div>\n\n                    <div className=\"columnName\">\n                      {isEditActive && product.id === isEditActiveId\n                        ? (\n                          <InputEditProductsName\n                            id={product.id}\n                            description={product.description}\n                            setEditActive={this.setEditActive}\n                            setIsProductsUpdated={this.props.setIsProductsUpdated}\n                            isProductsUpdated={this.props.isProductsUpdated}\n                          />\n                        )\n                        : <p>{product.description}</p>}\n                    </div>\n\n                    <div className=\"columnPrice\">\n                      {isEditActive && product.id === isEditActiveId\n                        ? (\n                          <InputEditProductsPrice\n                            id={product.id}\n                            price={product.price}\n                            setEditActive={this.setEditActive}\n                            setIsProductsUpdated={this.props.setIsProductsUpdated}\n                            isProductsUpdated={this.props.isProductsUpdated}\n                          />\n                        )\n                        : <p>{product.price}</p>}\n                    </div>\n\n                    <div className=\"columnInStock\">\n                      {isEditActive && product.id === isEditActiveId\n                        ? (\n                          <InputEditProductsInStock\n                            id={product.id}\n                            inStock={product.inStock}\n                            setEditActive={this.setEditActive}\n                            setIsProductsUpdated={this.props.setIsProductsUpdated}\n                            isProductsUpdated={this.props.isProductsUpdated}\n                          />\n                        )\n                        : <p className=\"inStockString\">{Number(product.inStock) === 1 ? 'да' : 'нет'}</p>}\n                    </div>\n\n                    <div className=\"columnEdit\">\n                      <button\n                        type=\"button\"\n                        className=\"editProductsButton\"\n                        onClick={() => {\n                          this.setState({\n                            isEditActive: true,\n                            isEditActiveId: product.id,\n                          });\n                          this.props.isProductsUpdated\n                            ? this.props.setIsProductsUpdated(false)\n                            : this.props.setIsProductsUpdated(true);\n                        }}\n                      >\n                        Редактировать\n                      </button>\n                    </div>\n\n                    <div className=\"columnDelete\">\n                      <button\n                        type=\"button\"\n                        className=\"deleteProductsButton\"\n                        onClick={() => {\n                          this.setState({\n                            isEditActive: true,\n                            isEditActiveId: product.id,\n                          });\n                          postDeleteCategory(product.id);\n                        }}\n                      >\n                        Удалить\n                      </button>\n                    </div>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n        <Footer />\n      </>\n    );\n  }\n}\n\nexport default EditProductsPage;\n"]},"metadata":{},"sourceType":"module"}